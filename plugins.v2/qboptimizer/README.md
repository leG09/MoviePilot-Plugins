# QB种子优化插件

## 插件简介

QB种子优化插件是一个专门为qBittorrent设计的种子管理优化工具，旨在提高下载效率和种子质量。

## 主要功能

### 1. 清理无人做种的种子
- **功能描述**：自动检测并删除做种数为0的下载任务，避免无效下载占用资源
- **触发条件**：种子处于下载状态且做种数小于等于设定阈值（没有人提供做种）
- **操作方式**：删除种子（保留文件），并尝试重新搜索下载
- **配置参数**：无人做种阈值（默认0）

### 2. 提升有人做种的下载优先级
- **功能描述**：按做种数排序，为做种数较多的下载任务设置更高优先级
- **触发条件**：种子处于下载状态且做种数大于等于设定阈值（有人提供做种）
- **操作方式**：按做种数排序，做种数最多的设为最高优先级1，依次递减
- **配置参数**：有人做种阈值（默认10）

### 3. 清理下载超时种子
- **功能描述**：删除下载时间过长的种子，释放下载槽位
- **触发条件**：种子处于下载状态且下载时间超过设定天数
- **操作方式**：删除种子和文件
- **配置参数**：下载超时天数（默认7天）

### 4. 自动重新下载
- **功能描述**：在清理无人做种的种子后，自动搜索并下载更好的替代种子
- **工作流程**：
  1. 提取种子名称，去除质量信息和发布组标识
  2. 使用MoviePilot搜索API查找替代种子
  3. 评估候选种子（做种数、大小相似度等）
  4. 自动下载最佳替代种子
- **配置参数**：启用自动重新下载开关（默认启用）
- **安全机制**：避免下载做种数为0的种子

## 配置说明

### 基础配置
- **启用插件**：开启/关闭插件功能
- **发送通知**：是否在执行操作后发送通知消息
- **下载器**：选择要优化的qBittorrent下载器
- **执行周期**：设置定时执行的时间间隔（Cron表达式）
- **立即运行一次**：手动触发一次优化操作

### 功能开关
- **清理无人做种的种子**：启用/禁用该功能
- **提升有人做种的下载优先级**：启用/禁用该功能
- **清理下载超时种子**：启用/禁用该功能
- **启用自动重新下载**：启用/禁用自动重新下载功能

### 参数配置
- **无人做种阈值**：做种数为0的判定阈值（默认0）
- **有人做种阈值**：触发优先级提升的做种数阈值（默认10）
- **下载超时天数**：种子下载超时的天数阈值（默认7天）

## 使用方法

### 1. 安装插件
将插件文件放置在MoviePilot的`plugins.v2/qboptimizer/`目录下

### 2. 配置插件
1. 在MoviePilot插件管理页面找到"QB种子优化"插件
2. 点击配置按钮进入配置页面
3. 根据需求设置各项参数
4. 保存配置

### 3. 启用插件
1. 开启"启用插件"开关
2. 设置执行周期（建议每6小时执行一次：`0 */6 * * *`）
3. 选择要优化的下载器
4. 根据需要开启相应的功能开关

### 4. 手动执行
- 使用"立即运行一次"按钮手动触发优化
- 或使用交互命令`/qb_optimize`执行优化
- 使用`/qb_status`查看当前状态

## 交互命令

插件提供以下交互命令：

- `/qb_optimize` - 执行QB种子优化
- `/qb_status` - 查看QB优化状态

## 注意事项

1. **数据安全**：插件会删除种子和文件，请确保配置正确后再启用
2. **仅支持qBittorrent**：目前仅支持qBittorrent下载器
3. **自动重新下载功能**：集成MoviePilot搜索API，自动搜索并下载替代种子
4. **优先级设置**：优先级提升功能需要qBittorrent支持
5. **执行频率**：建议不要设置过于频繁的执行周期，避免影响下载器性能

## 版本历史

- **v1.0**：首个版本，实现基础种子优化功能

## 技术支持

如有问题或建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 发送邮件反馈

## 免责声明

本插件仅供学习和个人使用，使用本插件产生的任何后果由用户自行承担。请在使用前仔细阅读配置说明，确保理解各项功能的作用。
