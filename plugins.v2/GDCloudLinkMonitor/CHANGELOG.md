# GDCloudLinkMonitor 更新日志

## 版本 2.7.0 (2025-01-25)

### 🆕 新增功能

#### 网盘限制检测功能
- **自动检测网盘状态**: 在文件转移前自动检测网盘是否被限制
- **智能轮询机制**: 当检测到网盘被限制时，自动选择下一个可用的网盘目录
- **缓存优化**: 避免频繁检测，提高性能，默认检测间隔5分钟
- **历史一致性**: 优先使用历史记录中的目录，保持同一剧集/电影系列在同一目录
- **容错处理**: 当所有网盘都被限制时，会记录错误并跳过文件处理

#### 配置选项
- **启用网盘限制检测**: 开启或关闭网盘限制检测功能
- **CloudDrive CLI路径**: 设置 clouddrive-cli 工具的完整路径
- **测试文件路径**: 设置用于检测的小文件路径
- **检测间隔**: 设置检测间隔时间，默认300秒（5分钟）

### 🔧 技术改进
- 添加了 `subprocess` 模块用于执行外部命令
- 新增 `_check_cloud_drive_status()` 方法用于检测网盘状态
- 新增 `_get_available_destination()` 方法用于选择可用目录
- 优化了轮询逻辑，支持网盘状态检测
- 添加了详细的日志记录，便于问题排查

### 📝 文档更新
- 新增 `CLOUD_CHECK_README.md` 详细说明网盘限制检测功能
- 新增 `test_cloud_check.py` 测试脚本，用于验证功能
- 新增 `test_file.txt` 测试文件，用于网盘检测
- 更新插件描述和版本信息

### 🐛 修复问题
- 修复了 `transferchian` 变量名拼写错误（虽然不影响功能，但保持代码规范）

### 📋 使用说明
1. 确保 clouddrive-cli 工具可用并配置正确路径
2. 准备一个小的测试文件（建议1KB左右的文本文件）
3. 在插件配置中启用网盘限制检测功能
4. 配置多个目标目录用于轮询
5. 设置合适的检测间隔时间

### ⚠️ 注意事项
- 检测功能依赖网络连接，确保网络环境稳定
- 建议使用小文件作为测试文件，避免占用过多存储空间
- 不要设置过短的检测间隔，避免频繁检测影响性能
- 确保插件有权限执行外部命令

---

## 版本 2.6.3 (之前版本)

### 功能特性
- 监控多目录文件变化
- 自动转移媒体文件
- 支持轮询分发
- 支持多种转移方式
- 支持刮削和通知
